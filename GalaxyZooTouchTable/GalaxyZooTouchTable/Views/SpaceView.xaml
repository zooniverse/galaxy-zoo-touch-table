<UserControl x:Class="GalaxyZooTouchTable.Views.SpaceView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:Behaviors="clr-namespace:GalaxyZooTouchTable.Behaviors"
             xmlns:views="clr-namespace:GalaxyZooTouchTable.Views"
             mc:Ignorable="d" 
             Height="432"
             Width="1248"
             d:DesignHeight="450"
             d:DesignWidth="800"
             DataContext="{Binding Source={StaticResource ViewModelLocator}, Path=SpaceViewModel}">

    <UserControl.Resources>
        <Style x:Key="MoveMapBorder" TargetType="{x:Type Border}">
            <Setter Property="Width" Value="94"/>
            <Setter Property="Height" Value="24"/>
            <Setter Property="CornerRadius" Value="3"/>
            <Setter Property="Background" Value="{StaticResource SuccessColor}"/>
            <Setter Property="Margin" Value="10"/>
        </Style>

        <Style x:Key="MoveMapText" TargetType="{x:Type TextBlock}">
            <Setter Property="FontFamily" Value="/GalaxyZooTouchTable;component/Fonts/#Karla"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="Text" Value="Move map"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style x:Key="ErrorPanel" TargetType="{x:Type StackPanel}">
            <Setter Property="Visibility" Value="Visible"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=ShowError}" Value="False">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>

    <Grid>
        <Image Source="{Binding SpaceCutoutUrl}" Width="1248" Height="432"/>

        <ItemsControl ItemsSource="{Binding CurrentGalaxies}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <Canvas Width="1248" Height="432"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <views:GalaxyTileView/>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
            <ItemsControl.ItemContainerStyle>
                <Style TargetType="ContentPresenter">
                    <Setter Property="Canvas.Top" Value="{Binding Y}"/>
                    <Setter Property="Canvas.Left" Value="{Binding X}"/>
                </Style>
            </ItemsControl.ItemContainerStyle>
        </ItemsControl>

        <Border Style="{StaticResource MoveMapBorder}" HorizontalAlignment="Left" VerticalAlignment="Top">
            <i:Interaction.Behaviors>
                <Behaviors:TapBehavior Command="{Binding MoveViewNorth}"/>
            </i:Interaction.Behaviors>
            <Border.LayoutTransform>
                <RotateTransform Angle="180"/>
            </Border.LayoutTransform>
            <TextBlock Style="{StaticResource MoveMapText}"/>
        </Border>

        <Border Style="{StaticResource MoveMapBorder}" HorizontalAlignment="Right" VerticalAlignment="Top">
            <i:Interaction.Behaviors>
                <Behaviors:TapBehavior Command="{Binding MoveViewEast}"/>
            </i:Interaction.Behaviors>
            <Border.LayoutTransform>
                <RotateTransform Angle="-90"/>
            </Border.LayoutTransform>
            <TextBlock Style="{StaticResource MoveMapText}"/>
        </Border>

        <Border Style="{StaticResource MoveMapBorder}" HorizontalAlignment="Left" VerticalAlignment="Bottom">
            <i:Interaction.Behaviors>
                <Behaviors:TapBehavior Command="{Binding MoveViewWest}"/>
            </i:Interaction.Behaviors>
            <Border.LayoutTransform>
                <RotateTransform Angle="90"/>
            </Border.LayoutTransform>
            <TextBlock Style="{StaticResource MoveMapText}"/>
        </Border>

        <Border Style="{StaticResource MoveMapBorder}" HorizontalAlignment="Right" VerticalAlignment="Bottom">
            <i:Interaction.Behaviors>
                <Behaviors:TapBehavior Command="{Binding MoveViewSouth}"/>
            </i:Interaction.Behaviors>
            <TextBlock Style="{StaticResource MoveMapText}"/>
        </Border>
        <StackPanel Style="{StaticResource ErrorPanel}" HorizontalAlignment="Center" VerticalAlignment="Bottom" Orientation="Horizontal">
            <TextBlock Text="{Binding ErrorMessage}" Foreground="Red"/>
            <Button Content="X" Command="{Binding HideError}" Foreground="White" Background="Transparent" Margin="5,0" BorderThickness="0"/>
        </StackPanel>
    </Grid>
</UserControl>
